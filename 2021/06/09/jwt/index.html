
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />

    

    
    <title>jwt | 春江花月夜o</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="keywords" content="" />
    
    <meta name="description" content="简介JWT是一个含签名并携带用户相关信息的加密串，页面请求校验登录接口时，请求头中携带JWT串到后端服务，后端通过签名加密串匹配校验，保证信息未被篡改。校验通过则认为是可靠的请求，将正常返回数据。 构成JWT由三部分组成，分别是头信息header、有效载荷payload、签名signature，中间以（.）分隔 1xxx.yyy.zzz header由两部分组成，令牌类型（即：JWT）、散列算法（">
<meta property="og:type" content="article">
<meta property="og:title" content="jwt">
<meta property="og:url" content="http://example.com/2021/06/09/jwt/index.html">
<meta property="og:site_name" content="春江花月夜o">
<meta property="og:description" content="简介JWT是一个含签名并携带用户相关信息的加密串，页面请求校验登录接口时，请求头中携带JWT串到后端服务，后端通过签名加密串匹配校验，保证信息未被篡改。校验通过则认为是可靠的请求，将正常返回数据。 构成JWT由三部分组成，分别是头信息header、有效载荷payload、签名signature，中间以（.）分隔 1xxx.yyy.zzz header由两部分组成，令牌类型（即：JWT）、散列算法（">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/css/images/gu.jpg">
<meta property="article:published_time" content="2021-06-09T02:24:41.638Z">
<meta property="article:modified_time" content="2021-06-09T07:39:28.323Z">
<meta property="article:author" content="durian">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/css/images/gu.jpg">
    

    
        <link rel="alternate" href="/" title="春江花月夜o" type="application/atom+xml" />
    

    

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/libs/titillium-web/styles.css">

    
<link rel="stylesheet" href="/libs/source-code-pro/styles.css">


    
<link rel="stylesheet" href="/css/style.css">


    
<script src="/libs/jquery/3.5.0/jquery.min.js"></script>

    
    
        
<link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">

    
    
        
<link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">

    
    
    
    


<meta name="generator" content="Hexo 5.2.0"></head>

<body>
    <div id="wrap">
        <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a href="/" class="logo"></a>
                    </h1>
                    
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">主页</a>
                                </li>
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">关于</a>
                                </li>
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/%5Bobject%20Object%5D">python</a>
                                    <ul class="main-nav-list-child">
                                        <li class="main-nav-list-item">
                                            
                                        </li>
                                    </ul>
                                </li>
                                
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">cpp</a>
                                </li>
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/%5Bobject%20Object%5D">webframe</a>
                                    <ul class="main-nav-list-child">
                                        <li class="main-nav-list-item">
                                            
                                                <a class="main-nav-list-link" href="/null">flask</a>
                                            
                                                <a class="main-nav-list-link" href="/null">django</a>
                                            
                                        </li>
                                    </ul>
                                </li>
                                
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">algorithm</a>
                                </li>
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">bigdata</a>
                                </li>
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/%5Bobject%20Object%5D">nosql</a>
                                    <ul class="main-nav-list-child">
                                        <li class="main-nav-list-item">
                                            
                                                <a class="main-nav-list-link" href="/null"> redis</a>
                                            
                                                <a class="main-nav-list-link" href="/null">mysql</a>
                                            
                                                <a class="main-nav-list-link" href="/null"> redis高级篇</a>
                                            
                                                <a class="main-nav-list-link" href="/null">mysql高级篇</a>
                                            
                                        </li>
                                    </ul>
                                </li>
                                
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="想要查找什么..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>


</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
    <h1 class="header">
    
    <a class="page-title-link" href="/categories/webframe/">webframe</a>
    </h1>
</div>

                        <div class="main-body-content">
                            <article id="post-jwt" class="article article-single article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        jwt
        </h1>
    

            </header>
        
        
            <div class="article-meta">
                
  <div class="article-date">
    <i class="fa fa-calendar"></i>
    <a href="/2021/06/09/jwt/" class="article-date">
       <time datetime="2021-06-09T02:24:41.638Z" itemprop="datePublished">2021-06-09</time>
    </a>
  </div>


<div class="article-date">
  <i class="fa fa-calendar-plus-o"></i>
  <a href="/2021/06/09/jwt/" class="article-date">
     <time datetime="2021-06-09T07:39:28.323Z" itemprop="dateModified">2021-06-09</time>
  </a>
</div>


                

                
                
   <div class="article-counter">
      <i class="fa fa-file-word-o"></i>
      <span class="post-count-item-text">本文字数: </span>
      <span class="post-count">2k</span>
      <i class="fa fa-clock-o"></i>
      <span class="post-time-item-text">阅读时长: </span>
      <span class="post-count">9 分钟 </span>
   </div>


                <span id="busuanzi_container_page_pv">
                阅读次数<span id="busuanzi_value_page_pv"></span>次
                </span>
            </div>
        
        
        <div class="article-entry" itemprop="articleBody">
            

            

            

            <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>JWT是一个含签名并携带用户相关信息的加密串，页面请求校验登录接口时，<br>请求头中携带JWT串到后端服务，后端通过签名加密串匹配校验，保证信息未<br>被篡改。校验通过则认为是可靠的请求，将正常返回数据。</p>
<h2 id="构成"><a href="#构成" class="headerlink" title="构成"></a>构成</h2><p>JWT由三部分组成，分别是头信息header、有效载荷payload、签名signature，中间以（.）分隔</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xxx.yyy.zzz</span><br></pre></td></tr></table></figure>
<h3 id="header"><a href="#header" class="headerlink" title="header"></a>header</h3><p>由两部分组成，令牌类型（即：JWT）、散列算法（HMAC、RSASSA、RSASSA-PSS等），例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot;: &quot;HS256&quot;,</span><br><span class="line">  &quot;typ&quot;: &quot;JWT&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后，这个JSON被编码为Base64Url，形成JWT的第一部分。</p>
<h3 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h3><p>JWT的第二部分是payload，其中包含claims。claims是关于实体（常用的是用户信息）<br>和其他数据的声明，claims有三种类型： registered, public, and private claims。</p>
<ul>
<li><p>1.Registered claims： 这些是一组预定义的claims，非强制性的，但是推荐使用，<br>iss（发行人）， exp（到期时间）， sub（主题）， aud（观众）等；</p>
</li>
<li><p>2.Public claims: 自定义claims，注意不要和JWT注册表中属性冲突，这里可以查看JWT注册表；</p>
</li>
<li><p>3.Private claims: 这些是自定义的claims，用于在同意使用这些claims的各方之间共享信息，<br>它们既不是Registered claims，也不是Public claims。</p>
</li>
<li><p>以下是payload示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;sub&quot;: &quot;1234567890&quot;,</span><br><span class="line">  &quot;name&quot;: &quot;John Doe&quot;,</span><br><span class="line">  &quot;admin&quot;: true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后，再经过Base64Url编码，形成JWT的第二部分。</p>
</li>
<li><p>注意<br>对于签名令牌，此信息虽然可以防止篡改，但任何人都可以读取。除非加密，<br>否则不要将敏感信息放入到Payload或Header元素中。</p>
</li>
</ul>
<h3 id="Signature"><a href="#Signature" class="headerlink" title="Signature"></a>Signature</h3><p>要创建签名部分，必须采用编码的Header，编码的Payload，秘钥，Header中指定的算法，并对其进行签名。<br>例如，如果要使用HMAC SHA256算法，将按以下方式创建签名：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HMACSHA256(</span><br><span class="line">  base64UrlEncode(header) + &quot;.&quot; +</span><br><span class="line">  base64UrlEncode(payload),</span><br><span class="line">  secret)</span><br></pre></td></tr></table></figure>

<p>签名用于验证消息在此过程中未被篡改，并且，在使用私钥签名令牌的情况下，<br>它还可以验证JWT的请求方是否是它所声明的请求方。输出是三个由点分隔的<br>Base64-URL字符串，可以在HTML和HTTP环境中轻松传递，与SAML等基于XML<br>的标准相比更加紧凑。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.</span><br><span class="line">eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.</span><br><span class="line">SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</span><br></pre></td></tr></table></figure>

<h2 id="jwt存储方式"><a href="#jwt存储方式" class="headerlink" title="jwt存储方式"></a>jwt存储方式</h2><h3 id="localStorage-sessionStorage存储"><a href="#localStorage-sessionStorage存储" class="headerlink" title="localStorage/sessionStorage存储"></a>localStorage/sessionStorage存储</h3><p>响应正文将包含JWT作为一个访问令牌:</p>
<ul>
<li><p>后台api</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">HTTP&#x2F;1.1 200 OK</span><br><span class="line"> </span><br><span class="line">  &#123;</span><br><span class="line">  &quot;access_token&quot;: &quot;eyJhbGciOiJIUzI1NiIsI.eyJpc3MiOiJodHRwczotcGxlL.mFrs3Zo8eaSNcxiNfvRh9dqKP4F1cB&quot;,</span><br><span class="line">  &quot;expires_in&quot;:3600</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在客户端，你可以将这个令牌存储在HTML5 Web存储中(假设我们有一个成功的回调函数)：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function tokenSuccess(err, response) &#123;</span><br><span class="line">    if(err)&#123;</span><br><span class="line">        throw err;</span><br><span class="line">    &#125;</span><br><span class="line">    $window.sessionStorage.accessToken &#x3D; response.body.access_token;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>回传访问令牌到你受保护的API，你将使用HTTP Authorization Header和Bearer组合。请求你的SPA将会像:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">HTTP&#x2F;1.1</span><br><span class="line">GET &#x2F;xxx</span><br><span class="line">Host: xxx.com</span><br><span class="line">Authorization: Bearer eyJhbGciOiJIUzI1NiIsI.</span><br><span class="line">eyJpc3MiOiJodHRwczotcGxlL.</span><br><span class="line">mFrs3Zo8eaSNcxiNfvRh9dqKP4F1cB</span><br></pre></td></tr></table></figure>
<h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><p>如果在Authorization header中发送令牌，则跨域资源共享（CORS）将不会成为问题，因为它不使用cookie，<br>这样可以用jwt做简单的单点登录，分离出登录系统做sso。</p>
</li>
</ul>
<h4 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h4><ul>
<li>xss攻击<br>Web存储(localStorage/sessionStorage)可以通过同一域上JavaScript访问。<br>这意味着任何在你的网站上运行的JavaScript都可以访问Web存储，因为这样容易<br>受到跨站点脚本（XSS）攻击。(最好确定用https发送jwt)</li>
</ul>
<h3 id="cookie存储"><a href="#cookie存储" class="headerlink" title="cookie存储"></a>cookie存储</h3><ul>
<li>后端通过response.set_cookie进行设置</li>
<li>回传访问令牌到你同一领域受保护的API，浏览器将自动包括cookie的值。请求你受保护的API将类似于:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GET &#x2F;xxx</span><br><span class="line">Host: xxx.com</span><br><span class="line">Cookie: access_token&#x3D;eyJhbGciOiJIUzI1NiIsI.</span><br><span class="line">eyJpc3MiOiJodHRwczotcGxlL.</span><br><span class="line">mFrs3Zo8eaSNcxiNfvRh9dqKP4F1cB;</span><br></pre></td></tr></table></figure>
<h4 id="优点-1"><a href="#优点-1" class="headerlink" title="优点"></a>优点</h4>Cookies，当使用带有HttpOnly的cookie标志时，通过<br>JavaScript是无法访问的，并且对XSS是免疫的。你还可<br>以设置安全的cookie标志来保证cokie仅通过HTTPS发送。<br>这是过去利用cookie存储令牌或会话数据的主要原因之一。<br>现代开发人员不愿使用cookie,因为它们通常要求状态被存<br>储在服务器上,从而打破RESTful的最佳实践。如果你在cookie<br>上存储JWT，cookie作为存储机制不用将状态存储在服务器上。<br>这是因为JWT封装了所有服务器需要服务的请求。</li>
</ul>
<h4 id="缺点-1"><a href="#缺点-1" class="headerlink" title="缺点"></a>缺点</h4><ul>
<li>csrf攻击<br>cookies容易受到不同类型的攻击：跨站点请求伪造(CSRF)。</li>
<li>解决设置cookie同源、同域、path等</li>
</ul>
<h2 id="jwt的缺点"><a href="#jwt的缺点" class="headerlink" title="jwt的缺点"></a>jwt的缺点</h2><h3 id="无法满足注销场景"><a href="#无法满足注销场景" class="headerlink" title="无法满足注销场景"></a>无法满足注销场景</h3><p>传统注销清空session即可，因为服务端保存状态。而jwt是无状态的，一旦被生成<br>在过期时间没到之前都是可用的，虽然注销后可以删除cookie中的jwt，但不代表这个<br>jwt不可用。</p>
<h3 id="无法满足修改密码场景"><a href="#无法满足修改密码场景" class="headerlink" title="无法满足修改密码场景"></a>无法满足修改密码场景</h3><p>修改密码后，盗号者在原jwt有效期内还是可以使用，如果你没有把password加入jwt（应该都不会把）。</p>
<h3 id="无法满足token续签场景"><a href="#无法满足token续签场景" class="headerlink" title="无法满足token续签场景"></a>无法满足token续签场景</h3><p>jwt严格定义过期时间，一旦生成，就无法续签延时。</p>
<h2 id="django-flask实操jwt登录"><a href="#django-flask实操jwt登录" class="headerlink" title="django/flask实操jwt登录"></a>django/flask实操jwt登录</h2><p>以django为例的jwt使用</p>
<h3 id="大致流程概述"><a href="#大致流程概述" class="headerlink" title="大致流程概述"></a>大致流程概述</h3><p>这里其实可以自己手动定制一个简单的jwt，并不复杂，但没必要-vvvvvv-嘿嘿，但还是可以，但……。</p>
<ul>
<li>1.生成payload里面带有user_id,exp(过期时间),username,email,aud,iat(issued at)甚至可以带权限</li>
<li>2.调准过期时间，payload用json.dumps编码为字符，并encode为二进制。</li>
<li>3.分别对payload，header(也需要dumps、encode一下下)（在setting中配置）进行base64编码</li>
<li>4.通过header中的algorithm拿到算法，获取secretkey（alg.prepare_key(key)）<br>再获取signature：alg.sign(signing_input, secretkey)</li>
<li>5.对signature进行base64，然后把三个段结合在一起。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#默认自带算法</span><br><span class="line">&#39;none&#39;: NoneAlgorithm(),</span><br><span class="line">&#39;HS256&#39;: HMACAlgorithm(HMACAlgorithm.SHA256),</span><br><span class="line">&#39;HS384&#39;: HMACAlgorithm(HMACAlgorithm.SHA384),</span><br><span class="line">&#39;HS512&#39;: HMACAlgorithm(HMACAlgorithm.SHA512)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="安装和简单使用"><a href="#安装和简单使用" class="headerlink" title="安装和简单使用"></a>安装和简单使用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">pip install djangorestframework-jwt</span><br><span class="line">pip install django-cors-header</span><br><span class="line">from rest_framework_jwt.serializers import jwt_encode_handler, jwt_payload_handler</span><br><span class="line">from rest_framework_jwt.authentication import JSONWebTokenAuthentication</span><br><span class="line"># 伪代码</span><br><span class="line">def create(self, request, *args, **kwargs):</span><br><span class="line">    serializer &#x3D; self.get_serializer(data&#x3D;request.data)</span><br><span class="line">    serializer.is_valid(raise_exception&#x3D;True)</span><br><span class="line">    user &#x3D; self.perform_create(serializer)</span><br><span class="line">    # token和payload的生成</span><br><span class="line">    re_dict &#x3D; serializer.data</span><br><span class="line">    payload &#x3D; jwt_payload_handler(user)</span><br><span class="line">    print(request.auth)</span><br><span class="line">    re_dict[&#39;token&#39;] &#x3D; jwt_encode_handler(payload)</span><br><span class="line">    re_dict[&#39;name&#39;] &#x3D; user.name if user.name else user.username</span><br><span class="line">    headers &#x3D; self.get_success_headers(serializer.data)</span><br><span class="line">    return Response(re_dict, status&#x3D;status.HTTP_201_CREATED, headers&#x3D;headers)</span><br></pre></td></tr></table></figure>

<h3 id="jwt-payload-handler生成payload"><a href="#jwt-payload-handler生成payload" class="headerlink" title="jwt_payload_handler生成payload"></a>jwt_payload_handler生成payload</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">注意这里payload的信息</span><br><span class="line">def jwt_payload_handler(user):</span><br><span class="line">    username_field &#x3D; get_username_field()</span><br><span class="line">    username &#x3D; get_username(user)</span><br><span class="line">    warnings.warn(</span><br><span class="line">        &#39;The following fields will be removed in the future: &#39;</span><br><span class="line">        &#39;&#96;email&#96; and &#96;user_id&#96;. &#39;,</span><br><span class="line">        DeprecationWarning</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    payload &#x3D; &#123;</span><br><span class="line">        &#39;user_id&#39;: user.pk,</span><br><span class="line">        &#39;username&#39;: username,</span><br><span class="line">        &#39;exp&#39;: datetime.utcnow() + api_settings.JWT_EXPIRATION_DELTA</span><br><span class="line">    &#125;</span><br><span class="line">    if hasattr(user, &#39;email&#39;):</span><br><span class="line">        payload[&#39;email&#39;] &#x3D; user.email</span><br><span class="line">    if isinstance(user.pk, uuid.UUID):</span><br><span class="line">        payload[&#39;user_id&#39;] &#x3D; str(user.pk)</span><br><span class="line"></span><br><span class="line">    payload[username_field] &#x3D; username</span><br><span class="line"></span><br><span class="line">    # Include original issued at time for a brand new token,</span><br><span class="line">    # to allow token refresh</span><br><span class="line">    if api_settings.JWT_ALLOW_REFRESH:</span><br><span class="line">        payload[&#39;orig_iat&#39;] &#x3D; timegm(</span><br><span class="line">            datetime.utcnow().utctimetuple()</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    if api_settings.JWT_AUDIENCE is not None:</span><br><span class="line">        payload[&#39;aud&#39;] &#x3D; api_settings.JWT_AUDIENCE</span><br><span class="line"></span><br><span class="line">    if api_settings.JWT_ISSUER is not None:</span><br><span class="line">        payload[&#39;iss&#39;] &#x3D; api_settings.JWT_ISSUER</span><br><span class="line"></span><br><span class="line">    return payload</span><br></pre></td></tr></table></figure>

<h3 id="jwt-encode-handler获取jwt-token"><a href="#jwt-encode-handler获取jwt-token" class="headerlink" title="jwt_encode_handler获取jwt_token"></a>jwt_encode_handler获取jwt_token</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">def jwt_encode_handler(payload):</span><br><span class="line">    key &#x3D; api_settings.JWT_PRIVATE_KEY or jwt_get_secret_key(payload)</span><br><span class="line">    return jwt.encode(</span><br><span class="line">        payload,</span><br><span class="line">        key,</span><br><span class="line">        api_settings.JWT_ALGORITHM</span><br><span class="line">    ).decode(&#39;utf-8&#39;)</span><br><span class="line"></span><br><span class="line"># jwt.encode 主要设置jwt本地过期时间、编码payload</span><br><span class="line">def encode(self,</span><br><span class="line">           payload,  # type: Union[Dict, bytes]</span><br><span class="line">           key,  # type: str</span><br><span class="line">           algorithm&#x3D;&#39;HS256&#39;,  # type: str</span><br><span class="line">           headers&#x3D;None,  # type: Optional[Dict]</span><br><span class="line">           json_encoder&#x3D;None  # type: Optional[Callable]</span><br><span class="line">           ):</span><br><span class="line">    # Check that we get a mapping</span><br><span class="line">    if not isinstance(payload, Mapping):</span><br><span class="line">        raise TypeError(&#39;Expecting a mapping object, as JWT only supports &#39;</span><br><span class="line">                        &#39;JSON objects as payloads.&#39;)</span><br><span class="line"></span><br><span class="line">    # Payload</span><br><span class="line">    for time_claim in [&#39;exp&#39;, &#39;iat&#39;, &#39;nbf&#39;]:</span><br><span class="line">        # Convert datetime to a intDate value in known time-format claims</span><br><span class="line">        if isinstance(payload.get(time_claim), datetime):</span><br><span class="line">            payload[time_claim] &#x3D; timegm(payload[time_claim].utctimetuple())  # type: ignore</span><br><span class="line"></span><br><span class="line">    json_payload &#x3D; json.dumps(</span><br><span class="line">        payload,</span><br><span class="line">        separators&#x3D;(&#39;,&#39;, &#39;:&#39;),</span><br><span class="line">        cls&#x3D;json_encoder</span><br><span class="line">    ).encode(&#39;utf-8&#39;)</span><br><span class="line"></span><br><span class="line">    return super(PyJWT, self).encode(</span><br><span class="line">        json_payload, key, algorithm, headers, json_encoder</span><br><span class="line">    )</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"># super(PyJWT, self).encode(</span><br><span class="line">            json_payload, key, algorithm, headers, json_encoder</span><br><span class="line">        ) # 获取jwt_token</span><br><span class="line">    def encode(self,</span><br><span class="line">               payload,  # type: Union[Dict, bytes]</span><br><span class="line">               key,  # type: str</span><br><span class="line">               algorithm&#x3D;&#39;HS256&#39;,  # type: str</span><br><span class="line">               headers&#x3D;None,  # type: Optional[Dict]</span><br><span class="line">               json_encoder&#x3D;None  # type: Optional[Callable]</span><br><span class="line">               ):</span><br><span class="line">        segments &#x3D; []</span><br><span class="line"></span><br><span class="line">        if algorithm is None:</span><br><span class="line">            algorithm &#x3D; &#39;none&#39;</span><br><span class="line"></span><br><span class="line">        if algorithm not in self._valid_algs:</span><br><span class="line">            pass</span><br><span class="line"></span><br><span class="line">        # Header</span><br><span class="line">        header &#x3D; &#123;&#39;typ&#39;: self.header_typ, &#39;alg&#39;: algorithm&#125;</span><br><span class="line"></span><br><span class="line">        if headers:</span><br><span class="line">            self._validate_headers(headers)</span><br><span class="line">            header.update(headers)</span><br><span class="line"></span><br><span class="line">        json_header &#x3D; force_bytes(</span><br><span class="line">            json.dumps(</span><br><span class="line">                header,</span><br><span class="line">                separators&#x3D;(&#39;,&#39;, &#39;:&#39;),</span><br><span class="line">                cls&#x3D;json_encoder</span><br><span class="line">            )</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        segments.append(base64url_encode(json_header))</span><br><span class="line">        segments.append(base64url_encode(payload))</span><br><span class="line"></span><br><span class="line">        # Segments</span><br><span class="line">        signing_input &#x3D; b&#39;.&#39;.join(segments)</span><br><span class="line">        try:</span><br><span class="line">            alg_obj &#x3D; self._algorithms[algorithm]</span><br><span class="line">            key &#x3D; alg_obj.prepare_key(key)</span><br><span class="line">            signature &#x3D; alg_obj.sign(signing_input, key)</span><br><span class="line"></span><br><span class="line">        except KeyError:</span><br><span class="line">            if not has_crypto and algorithm in requires_cryptography:</span><br><span class="line">                raise NotImplementedError(</span><br><span class="line">                    &quot;Algorithm &#39;%s&#39; could not be found. Do you have cryptography &quot;</span><br><span class="line">                    &quot;installed?&quot; % algorithm</span><br><span class="line">                )</span><br><span class="line">            else:</span><br><span class="line">                raise NotImplementedError(&#39;Algorithm not supported&#39;)</span><br><span class="line"></span><br><span class="line">        segments.append(base64url_encode(signature))</span><br><span class="line"></span><br><span class="line">        return b&#39;.&#39;.join(segments)</span><br></pre></td></tr></table></figure>




        </div>
        <footer class="article-footer">
            



    <a data-url="http://example.com/2021/06/09/jwt/" data-id="ckpowa9ng000afwmzfjnd2kjv" class="article-share-link"><i class="fa fa-share"></i>分享到</a>
<script>
    (function ($) {
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

        </footer>
    </div>
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "author": {
            "@type": "Person",
            "name": "durian"
        },
        "headline": "jwt",
        "image": "http://example.com/css/images/gu.jpg",
        "keywords": "",
        "genre": "webframe",
        "datePublished": "2021-06-09",
        "dateCreated": "2021-06-09",
        "dateModified": "2021-06-09",
        "url": "http://example.com/2021/06/09/jwt/",
        "description": "简介JWT是一个含签名并携带用户相关信息的加密串，页面请求校验登录接口时，请求头中携带JWT串到后端服务，后端通过签名加密串匹配校验，保证信息未被篡改。校验通过则认为是可靠的请求，将正常返回数据。
构成JWT由三部分组成，分别是头信息header、有效载荷payload、签名signature，中间以（.）分隔
1xxx.yyy.zzz
header由两部分组成，令牌类型（即：JWT）、散列算法（",
        "wordCount": 1844
    }
</script>

</article>

    <section id="comments">
    
        
    <!-- Valine -->
    <div class="vcomments"></div>


    
    </section>



                        </div>
                    </section>
                    <aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
    <div class="sidebar-top">
        <p>关注我 :</p>
        <ul class="social-links">
            
                
                <li>
                    <a class="social-tooltip" title="twitter" href="/" target="_blank" rel="noopener">
                        <i class="icon fa fa-twitter"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="facebook" href="/" target="_blank" rel="noopener">
                        <i class="icon fa fa-facebook"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="stack-overflow" href="/" target="_blank" rel="noopener">
                        <i class="icon fa fa-stack-overflow"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="github" href="https://github.com/ppoffice/hexo-theme-hueman" target="_blank" rel="noopener">
                        <i class="icon fa fa-github"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="weibo" href="/" target="_blank" rel="noopener">
                        <i class="icon fa fa-weibo"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="rss" href="/" target="_blank" rel="noopener">
                        <i class="icon fa fa-rss"></i>
                    </a>
                </li>
                
            
        </ul>
    </div>
    
        
<nav id="article-nav">
    
        <a href="/2021/06/09/flask%E8%BF%9E%E6%8E%A5redis%E9%9B%86%E7%BE%A4/" id="article-nav-newer" class="article-nav-link-wrap">
        <strong class="article-nav-caption">下一篇</strong>
        <p class="article-nav-title">
        
            (no title)
        
        </p>
        <i class="icon fa fa-chevron-right" id="icon-chevron-right"></i>
    </a>
    
    
        <a href="/2021/06/09/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95/" id="article-nav-older" class="article-nav-link-wrap">
        <strong class="article-nav-caption">上一篇</strong>
        <p class="article-nav-title">单点登录</p>
        <i class="icon fa fa-chevron-left" id="icon-chevron-left"></i>
        </a>
    
</nav>

    
    <div class="widgets-container">
        
            
                
<div class="widget-wrap widget-list">
    <h3 class="widget-title">目录</h3>
    <div class="widget">
        <div id="toc" class="toc-article">
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E6%88%90"><span class="toc-number">2.</span> <span class="toc-text">构成</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#header"><span class="toc-number">2.1.</span> <span class="toc-text">header</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#payload"><span class="toc-number">2.2.</span> <span class="toc-text">payload</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Signature"><span class="toc-number">2.3.</span> <span class="toc-text">Signature</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jwt%E5%AD%98%E5%82%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">3.</span> <span class="toc-text">jwt存储方式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#localStorage-sessionStorage%E5%AD%98%E5%82%A8"><span class="toc-number">3.1.</span> <span class="toc-text">localStorage&#x2F;sessionStorage存储</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E7%82%B9"><span class="toc-number">3.1.1.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9"><span class="toc-number">3.1.2.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cookie%E5%AD%98%E5%82%A8"><span class="toc-number">3.2.</span> <span class="toc-text">cookie存储</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-1"><span class="toc-number">3.2.1.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-1"><span class="toc-number">3.2.2.</span> <span class="toc-text">缺点</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jwt%E7%9A%84%E7%BC%BA%E7%82%B9"><span class="toc-number">4.</span> <span class="toc-text">jwt的缺点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E6%B3%95%E6%BB%A1%E8%B6%B3%E6%B3%A8%E9%94%80%E5%9C%BA%E6%99%AF"><span class="toc-number">4.1.</span> <span class="toc-text">无法满足注销场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E6%B3%95%E6%BB%A1%E8%B6%B3%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81%E5%9C%BA%E6%99%AF"><span class="toc-number">4.2.</span> <span class="toc-text">无法满足修改密码场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E6%B3%95%E6%BB%A1%E8%B6%B3token%E7%BB%AD%E7%AD%BE%E5%9C%BA%E6%99%AF"><span class="toc-number">4.3.</span> <span class="toc-text">无法满足token续签场景</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#django-flask%E5%AE%9E%E6%93%8Djwt%E7%99%BB%E5%BD%95"><span class="toc-number">5.</span> <span class="toc-text">django&#x2F;flask实操jwt登录</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A7%E8%87%B4%E6%B5%81%E7%A8%8B%E6%A6%82%E8%BF%B0"><span class="toc-number">5.1.</span> <span class="toc-text">大致流程概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%92%8C%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8"><span class="toc-number">5.2.</span> <span class="toc-text">安装和简单使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jwt-payload-handler%E7%94%9F%E6%88%90payload"><span class="toc-number">5.3.</span> <span class="toc-text">jwt_payload_handler生成payload</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jwt-encode-handler%E8%8E%B7%E5%8F%96jwt-token"><span class="toc-number">5.4.</span> <span class="toc-text">jwt_encode_handler获取jwt_token</span></a></li></ol></li></ol>
        </div>
    </div>
</div>


            
                
    <div class="widget-wrap">
        <h3 class="widget-title">最新文章</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2021/06/09/flask%E8%BF%9E%E6%8E%A5redis%E9%9B%86%E7%BE%A4/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2021/06/09/flask%E8%BF%9E%E6%8E%A5redis%E9%9B%86%E7%BE%A4/" class="title"></a></p>
                            <p class="item-date"><time datetime="2021-06-09T02:25:42.189Z" itemprop="datePublished">2021-06-09</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2021/06/09/jwt/" class="thumbnail">
    
    
        <span style="background-image:url(/css/images/gu.jpg)" alt="jwt" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/webframe/">webframe</a></p>
                            <p class="item-title"><a href="/2021/06/09/jwt/" class="title">jwt</a></p>
                            <p class="item-date"><time datetime="2021-06-09T02:24:41.638Z" itemprop="datePublished">2021-06-09</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2021/06/09/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95/" class="thumbnail">
    
    
        <span style="background-image:url(/css/images/gu.jpg)" alt="单点登录" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/webframe/">webframe</a></p>
                            <p class="item-title"><a href="/2021/06/09/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95/" class="title">单点登录</a></p>
                            <p class="item-date"><time datetime="2021-06-09T02:24:41.638Z" itemprop="datePublished">2021-06-09</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2021/06/08/flask-sqlaAchemy/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2021/06/08/flask-sqlaAchemy/" class="title"></a></p>
                            <p class="item-date"><time datetime="2021-06-08T03:54:22.148Z" itemprop="datePublished">2021-06-08</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2021/06/08/flask-wtforms/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2021/06/08/flask-wtforms/" class="title"></a></p>
                            <p class="item-date"><time datetime="2021-06-08T03:53:04.318Z" itemprop="datePublished">2021-06-08</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">分类</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/nosql/">nosql</a><span class="category-list-count">14</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/nosql/mysql%E9%AB%98%E7%BA%A7%E7%AF%87/">mysql高级篇</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/nosql/redis/">redis</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/nosql/redis%E9%AB%98%E7%BA%A7%E7%AF%87/">redis高级篇</a><span class="category-list-count">7</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/webframe/">webframe</a><span class="category-list-count">4</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/webframe/flask/">flask</a><span class="category-list-count">2</span></li></ul></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">归档</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">六月 2021</a><span class="archive-list-count">28</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a><span class="archive-list-count">2</span></li></ul>
        </div>
    </div>


            
                

            
                

            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">链接</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a target="_blank" rel="noopener" href="http://hexo.io">Hexo</a>
                    </li>
                
            </ul>
        </div>
    </div>


            
        
    </div>
</aside>

                </div>
            </div>
        </div>
        <footer id="footer">
    <div class="container">
        <div class="container-inner">
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" class="logo"></a>
                </h1>
                <p>&copy; 2021 durian</p>
                
                <p>Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>. Theme by <a href="https://github.com/ppoffice" target="_blank">PPOffice</a></p>
                
            </div>
                <p><span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span></p>
                <p><span id="busuanzi_container_site_uv"> 
                     本站访客数<span id="busuanzi_value_site_uv"></span>人次
               </span></p>
            <div class="footer-plugins">
              
    


            </div>
        </div>
    </div>
    <script src="//cdn1.lncld.net/static/js/2.5.0/av-min.js"></script>
</footer>

    </div>
    
    
    <script src="//unpkg.com/valine"></script>
    <script>
        var GUEST = ['nick','mail','link'];
        var meta = '';
        meta = meta.split(',').filter(function (item) {
            return GUEST.indexOf(item)>-1;
        });
        var avatarcdn = 'gravatar.cat.net' == true;
        new Valine({
            el: '.vcomments',
            notify: "false",
            verify: "false",
            appId: "795P9DunI2Jv3Jho36dlueIS-gzGzoHsz",
            appKey: "pM151YCVhYBYTB9Pt1SRuiKs",
            placeholder: "Just Do It",
            avatar:"mm",
            recordIP:"false",
            visitor: "true"
        });
    </script>





    
        
<script src="/libs/lightgallery/js/lightgallery.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-pager.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-zoom.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-hash.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-share.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-video.min.js"></script>

    
    
        
<script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>

    
    

    
    
    



<!-- Custom Scripts -->

<script src="/js/main.js"></script>


</body>
</html>
